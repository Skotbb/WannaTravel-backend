{"version":3,"sources":["../../models/country.js"],"names":["Schema","countrySchema","name","type","String","index","unique","cities","Types","ObjectId","ref","searchUrl","plugin","statics","addCountry","country","Country","findOne","err","result","console","log","create","search","model"],"mappings":";;;;;;;AAAA;;;;AACA;;;;AACA;;;;;;AAEA;;AAEA,IAAIA,SAAS,mBAASA,MAAtB;;AAEA,IAAMC,gBAAgB,IAAID,MAAJ,CAAW;AAChCE,OAAM,EAACC,MAAMC,MAAP,EAAeC,OAAO,IAAtB,EAA4BC,QAAQ,IAApC,EAD0B;AAEhCC,SAAQ,CAAC,EAACJ,MAAMH,OAAOQ,KAAP,CAAaC,QAApB,EAA8BC,KAAK,MAAnC,EAAD,CAFwB;AAGhCC,YAAWP;AAHqB,CAAX,CAAtB;AAKAH,cAAcW,MAAd;;AAGAX,cAAcY,OAAd,CAAsBC,UAAtB;AAAA,sDAAmC,iBAAOC,OAAP;AAAA;AAAA;AAAA;AAAA;AAClCC,cAAQC,OAAR,CAAgB,EAACf,MAAMa,QAAQb,IAAf,EAAhB,EAAsC,UAACgB,GAAD,EAAMC,MAAN,EAAiB;AACtDC,eAAQC,GAAR,CAAY,UAAZ;AACA;AACA,WAAI,CAACH,GAAL,EAAU;AACT;AACA,YAAI,CAACC,MAAL,EAAa;AACZ;AACAC,iBAAQC,GAAR,CAAY,qBAAZ;AACAL,iBAAQM,MAAR,CAAe;AACdpB,gBAAMa,QAAQb,IADA;AAEdS,qBAAWI,QAAQQ;AAFL,UAAf,EAGG,UAASL,GAAT,EAAcH,OAAd,EAAuB;AACzB,cAAGG,GAAH,EAAQ;AACPE,mBAAQC,GAAR,CAAYH,GAAZ;AACA,WAFD,MAEO;AACNE,mBAAQC,GAAR,CAAeN,QAAQb,IAAvB;AACA;AACD,UATD;AAUA;AACDkB,gBAAQC,GAAR,CAAY,gBAAZ;AACA;AACA,QAlBD,MAkBO;AACND,gBAAQC,GAAR,CAAYH,GAAZ;AACA;AACD,OAxBD;;AADkC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAAnC;;AAAA;AAAA;AAAA;AAAA;;AA4BA,IAAIF,UAAU,mBAASQ,KAAT,CAAe,WAAf,EAA4BvB,aAA5B,CAAd;;QAESe,O,GAAAA,O","file":"country.js","sourcesContent":["import mongoose from 'mongoose'\r\nimport findOrCreate from 'mongoose-findorcreate'\r\nimport { databaseName } from '../travel-settings'\r\n\r\n// mongoose.connect(`mongodb://localhost/${databaseName}`)\r\n\r\nlet Schema = mongoose.Schema;\r\n\r\nconst countrySchema = new Schema({\r\n\tname: {type: String, index: true, unique: true},\r\n\tcities: [{type: Schema.Types.ObjectId, ref: 'City'}],\r\n\tsearchUrl: String,\r\n});\r\ncountrySchema.plugin(findOrCreate)\r\n\r\n\r\ncountrySchema.statics.addCountry = async (country) => {\r\n\tCountry.findOne({name: country.name}, (err, result) => {\r\n\t\tconsole.log(\"Finding.\")\r\n\t\t// If no error\r\n\t\tif (!err) {\r\n\t\t\t// If no result\r\n\t\t\tif (!result) {\r\n\t\t\t\t// Create the country!\r\n\t\t\t\tconsole.log(\"Create new country.\")\r\n\t\t\t\tCountry.create({\r\n\t\t\t\t\tname: country.name,\r\n\t\t\t\t\tsearchUrl: country.search,\r\n\t\t\t\t}, function(err, country) {\r\n\t\t\t\t\tif(err) {\r\n\t\t\t\t\t\tconsole.log(err)\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconsole.log(`${country.name} created.`)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\tconsole.log(\"country in db.\")\r\n\t\t\treturn\r\n\t\t} else {\r\n\t\t\tconsole.log(err)\r\n\t\t}\r\n\t})\r\n}\r\n\r\nlet Country = mongoose.model('Countries', countrySchema);\r\n\r\nexport { Country }"]}